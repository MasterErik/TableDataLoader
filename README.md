
–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Å–ø–∏—Å–æ—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤, –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å MyBatis.

---

# TableDataLoader

**TableDataLoader** ‚Äî —ç—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞-–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –¥–ª—è —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –û–Ω–∞ —Å–≤—è–∑—ã–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–Ω–µ—à–Ω–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ (HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏, —Ñ–∏–ª—å—Ç—Ä—ã) —Å–æ —Å–ª–æ–µ–º –¥–∞–Ω–Ω—ã—Ö (MyBatis), –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ø–∞–≥–∏–Ω–∞—Ü–∏—é, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É, —Å–ª–æ–∂–Ω—É—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ç–∏–ø–æ–≤.

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é **–∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–∞ –æ—Ç Spring Framework** –∏ –≤–µ–±-–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ—ë –≤ –ª—é–±—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö —Å–ª–æ—è—Ö (gRPC, Kafka consumers, Servlets).

---

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

* **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç (`MapParam`):** –ï–¥–∏–Ω—ã–π DTO –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞.
* **Fluent API:** –£–¥–æ–±–Ω–æ–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ü–µ–ø–æ—á–µ–∫ —É—Å–ª–æ–≤–∏–π (`AND`, `OR`, —Å–∫–æ–±–∫–∏).
* **–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏).
* **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π SQL:** –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å MyBatis Dynamic SQL (`<foreach>`, `<if>`).
* **Master-Detail:** –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö (Header + Lines) –∑–∞ –æ–¥–∏–Ω –ø—Ä–æ—Ö–æ–¥.
* **–ì–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫:** –£–º–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –∫–æ–ª–æ–Ω–∫–∞–º —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö (String/Number).

---

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–î–æ–±–∞–≤—å—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞.

*–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:* Java 17+, Kotlin 1.9+ (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –Ω–∞–ø–∏—Å–∞–Ω–∞ –Ω–∞ Kotlin, –Ω–æ –∏–º–µ–µ—Ç Java-friendly API).

---

## üìñ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (MapParam)

`MapParam` ‚Äî —ç—Ç–æ "—Å–µ—Ä–¥—Ü–µ" –±–∏–±–ª–∏–æ—Ç–µ–∫–∏. –û–Ω —Ö—Ä–∞–Ω–∏—Ç –≤—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

```java
import su.erik.tabledataloader.param.MapParam;
import su.erik.tabledataloader.param.Filter;

// –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
MapParam mapParam = new MapParam();

// 1. –ü–∞–≥–∏–Ω–∞—Ü–∏—è –∏ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
mapParam.setLimit(20);
mapParam.setOffset(0);
mapParam.addOrderBy("created_at", "DESC"); 

// 2. –ü—Ä–æ—Å—Ç—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã (–ø–æ–ø–∞–¥–∞—é—Ç –≤ mapParam.filters)
mapParam.setUserId(100L); // –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
mapParam.addCustomFilter("status", "ACTIVE"); // –ö–∞—Å—Ç–æ–º–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è MyBatis

// 3. –°–ª–æ–∂–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ (SQL WHERE)
mapParam.addCriteria("age", ">", 18)
        .openBracket() // (
            .addCriteria("city", "Moscow")
            .addCriteria("city", "London", Filter.SqlSuffix.OR) // OR city = 'London'
        .closeBracket(); // )

```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (TableDataLoader)

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `TableDataLoader` –¥–ª—è —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å –≤–∞—à–∏–º Mapper'–æ–º.

```java
import su.erik.tabledataloader.TableDataLoader;
import su.erik.tabledataloader.dto.DataResponse;

// –í –≤–∞—à–µ–º –°–µ—Ä–≤–∏—Å–µ:
public DataResponse<MyDto> getMyData(MapParam params) {
    
    return TableDataLoader.<MyDto>create()
            .setMapParam(params)
            // –£–∫–∞–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ –º–∞–ø–ø–µ—Ä–∞ –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö
            .useToGetData(myBatisMapper::selectData) 
            // –£–∫–∞–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ –º–∞–ø–ø–µ—Ä–∞ –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ (–¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏)
            .useToCount(myBatisMapper::countData)
            .build();
}

```

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å MyBatis (XML)

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –æ–∂–∏–¥–∞–µ—Ç, —á—Ç–æ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ `MapParam` –≤ –≤–∞—à–µ–º XML –º–∞–ø–ø–µ—Ä–µ.

**Java Interface:**

```java
List<MyDto> selectData(@Param("mapParam") MapParam mapParam);
Long countData(@Param("mapParam") MapParam mapParam);

```

**MyBatis XML Template:**

```xml
<select id="selectData" resultType="MyDto">
    SELECT * FROM my_table t
    <where>
        <if test="mapParam.filters.status != null">
            AND t.status = #{mapParam.filters.status}
        </if>
        
        <if test="mapParam.criteria != null and !mapParam.criteria.isEmpty()">
            AND (
            <foreach collection="mapParam.criteria" item="criterion">
                ${criterion.lBracket}
                
                t.${criterion.field} ${criterion.op} #{criterion.value}
                
                ${criterion.rBracket}
                
                ${criterion.sqlSuffix}
            </foreach>
            )
        </if>
    </where>
    
    <if test="mapParam.orderBy != null and !mapParam.orderBy.isEmpty()">
        ORDER BY
        <foreach collection="mapParam.orderBy" item="sort" separator=",">
            ${sort.sortBy} ${sort.sortOrder}
        </foreach>
    </if>
    
    <if test="mapParam.limit != null">
        LIMIT #{mapParam.limit} OFFSET #{mapParam.offset}
    </if>
</select>

```

---

## ‚öñÔ∏è –ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞ –∏ –í–∞–ª–∏–¥–∞—Ü–∏—è

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –Ω–∞–≤—è–∑—ã–≤–∞–µ—Ç —Å—Ç—Ä–æ–≥–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö.

### üõë –ü—Ä–∞–≤–∏–ª–æ U007: Mandatory Sorting

–ï—Å–ª–∏ –≤ –∑–∞–ø—Ä–æ—Å–µ —É–∫–∞–∑–∞–Ω–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏—è (`limit` –∏–ª–∏ `offset` –Ω–µ null), –∑–∞–ø—Ä–æ—Å **–æ–±—è–∑–∞–Ω** —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ (`orderBy`).

* *–ü–æ—á–µ–º—É:* –ë–µ–∑ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ—Ä—è–¥–æ–∫ –∑–∞–ø–∏—Å–µ–π –≤ SQL –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω (heap scan order), —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ "–ø–ª–∞–≤–∞—é—â–∏–º" –∑–∞–ø–∏—Å—è–º –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü.
* *–ü–æ–≤–µ–¥–µ–Ω–∏–µ:* –ú–µ—Ç–æ–¥ `build()` –≤—ã–±—Ä–æ—Å–∏—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ `RuntimeException` (–∫–æ–¥ U007).

### üîí –ò–∑–æ–ª—è—Ü–∏—è

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç `javax.servlet` –∏–ª–∏ `spring-web`.

* –î–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É—Ç–∏–ª–∏—Ç—É `HeaderUtils.fillMapParam`.
* –û–Ω–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `Function<String, String>`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ª—é–±–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ (ServletRequest, Map, gRPC Metadata).

---

## üß© –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### Master-Detail (–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞)

–ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ä–æ–¥–∏—Ç–µ–ª–µ–π –∏ –∏—Ö –¥–æ—á–µ—Ä–Ω–∏—Ö –∑–∞–ø–∏—Å–µ–π, –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤.

```java
TableDataLoader.<ParentDto>create()
    .setMapParam(params)
    .useToGetData(mapper::selectParents)
    // –£–∫–∞–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–µ—Ç–µ–π –ø–æ —Å–ø–∏—Å–∫—É ID —Ä–æ–¥–∏—Ç–µ–ª–µ–π
    .useChildList(mapper::selectChildrenByMasterIds) 
    .build();

```

* –í –º–∞–ø–ø–µ—Ä–µ `selectChildrenByMasterIds` –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `WHERE parent_id IN <foreach collection="mapParam.masterListId" ...>`.
* –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Å–∞–º–∞ —Å–æ–ø–æ—Å—Ç–∞–≤–∏—Ç –¥–µ—Ç–µ–π —Å —Ä–æ–¥–∏—Ç–µ–ª—è–º–∏ –≤ –ø–∞–º—è—Ç–∏.

### –ì–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ (TableSearch)

–ü–∞—Ä–∞–º–µ—Ç—Ä `keywordSearch` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è:

* –ï—Å–ª–∏ —ç—Ç–æ —á–∏—Å–ª–æ ‚Äî –ø–æ–∏—Å–∫ –±—É–¥–µ—Ç –≤–µ—Å—Ç–∏—Å—å –ø–æ —á–∏—Å–ª–æ–≤—ã–º –ø–æ–ª—è–º.
* –ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ ‚Äî –ø–æ —Å—Ç—Ä–æ–∫–æ–≤—ã–º (—á–µ—Ä–µ–∑ LIKE).

–í –º–∞–ø–ø–µ—Ä–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–ª–ª–µ–∫—Ü–∏—é `mapParam.columns`.

---

## üì¶ –≠–∫–æ—Å–∏—Å—Ç–µ–º–∞ (Roadmap)

–í –±—É–¥—É—â–µ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –±—É–¥–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω —Å–ª–µ–¥—É—é—â–∏–º–∏ –º–æ–¥—É–ª—è–º–∏:

* **file-import-export**: –ú–æ–¥—É–ª—å –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞/—ç–∫—Å–ø–æ—Ä—Ç–∞ (CSV, Excel) —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã `FileImporter` / `FileExporter`.
* **archive-support**: –ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ ZIP-–∞—Ä—Ö–∏–≤–æ–≤ —Å —Ñ–∞–π–ª–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö.